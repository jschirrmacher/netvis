<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Network Visualizer</title>
    <link rel="stylesheet" type="text/css" href="netvis.css" />
    <!-- only for example reasons -->
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">
</head>
<body>
    <svg id="root">
        <rect class="commands commandOverlay" x="0" y="0" width="100%" height="100%" fill="rgba(0, 0, 0, 0.2)"></rect>
        <g class="commands commandContainer">
            <foreignObject>
                <button id="openNode" class="command" data-click="openNode" data-visible="!node.open"
                        title="Show connections">&#xe096;</button>
                <button id="closeNode" class="command" data-click="closeNode" data-visible="node.open"
                        title="Hide connections">&#xe097;</button>
                <button id="newConnection" class="command" data-click="newConnection" data-visible="node.connectable"
                        title="Create new connection">+</button>
                <button id="removeNode" class="command" data-click="removeNode" data-visible="node.deletable"
                        title="Delete node">&#xe014</button>
                <button id="showDetails" class="command" data-click="showDetails" data-visible="node.details"
                        title="Show details">i</button>
            </foreignObject>
        </g>
    </svg>

    <div class="zoom">
        <div>
            <div id="zoomOut" onclick="network.scale(0.66)" title="Zoom out">&#xe016</div>
            <div id="zoomIn" onclick="network.scale(1.5)" title="Zoom in">&#xe015</div>
        </div>
    </div>

    <script id="detailForm" type="text/x-handlebars-template">
        <h2>
            <button class="close">Ã—</button>
            {{name}}
        </h2>

        <img src="{{image}}" class="profile-picture">

        <p>{{description}}</p>

        <a href="{{url}}" target="_blank">{{url}}</a>

        <p class="tag-view">
            {{#each links}}<span class="tag">{{this.name}}</span>{{/each}}
        </p>
    </script>

    <script src="//d3js.org/d3.v4.min.js"></script>
    <script src="../dist/Network.js"></script>
    <script src="../dist/ForceDiagram.js"></script>

    <!-- Only needed for the example -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>

    <script>
      const source = document.getElementById('detailForm').innerHTML
      const detailFormTemplate = Handlebars.compile(source)
      const network = new Network('data.json', '#root', {
        nameRequired: function() {
          return Promise.resolve(window.prompt('Name'))
        },
        newNode: function(name) {
          console.log('New node', name)
          return {name, shape: 'circle'}
        },
        nodeRemoved: function(node) {
          console.log('Node removed', node)
        },
        newLink: function(link) {
          console.log('New link', link)
        },
        showDetails: function(data) {
          return new Promise(resolve => {
            const form = document.createElement('div')
            form.setAttribute('class', 'detailForm')
            form.innerHTML = detailFormTemplate(data)
            form.getElementsByClassName('close')[0].addEventListener('click', event => {
              event.preventDefault()
              form.parentNode.removeChild(form)
              resolve()
            })
            document.body.appendChild(form)
          })
        }
      })
    </script>

</body>
</html>
